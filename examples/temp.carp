;;(Project.config "echo-compiler-cmd" true)
;; (Debug.sanitize-addresses)

(Project.config "print-ast" true)

(deftype Enemy [hp Int
                attack (Fn [Int] Int)])

(defn attack [attacker target]
  (let [f @(Enemy.attack attacker)
        new-hp (f @(Enemy.hp &target))]
    (Enemy.set-hp target new-hp)))

(defn main []
  (let [enemy (Enemy.init 100 dec)
        hero (Enemy.init 100 dec)]
    (println* &(attack &enemy hero))))
