(defn pretty-signature (t)
  (match t
         (:fn args ret) (str "(" (join ", " (map pretty-signature args)) ") -> " (pretty-signature ret))
         (:ref r) (str "&" (pretty-signature r) "")
         x (if (keyword? t) (name t)
               (error (str "Invalid type signature: " t)))))
